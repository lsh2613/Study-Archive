# 01 개략적인 규모 측정
## 개략적인 규모 추정
보편적으로 통용되는 `성능 수치상`에서 `사고 실험`을 행해 `추정치`를 계산하는 행위로서, 어떤 설계가 `요구사항`에 `부합`할 것인지 보기 위한 것 - 제프 딘(Jeff Dean)
- `2의 제곱수`, `응답지연`, `가용성에 관계된 수치`들을  이해하고 있어야 한다

## 2의 제곱수
- 데이터 양의 계산 결과를 얻으려면 2의 데이터 단위를 2의 제곱수로 표현하는 법을 알아야 한다
- 최소 단위는 1바이트 (=8비트)
- ASCII 문자는 1바이트
<table>
    <thead>
        <tr>
            <th>2의 제곱수</th>
            <th>근사치</th>
            <th>이름</th>
            <th>축약형</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>2<sup>10</sup></td>
            <td>1,000</td>
            <td>1 킬로바이트</td>
            <td>1 KB</td>
        </tr>
        <tr>
            <td>2<sup>20</sup></td>
            <td>1,000,000</td>
            <td>1 메가바이트</td>
            <td>1 MB</td>
        </tr>
        <tr>
            <td>2<sup>30</sup></td>
            <td>1,000,000,000</td>
            <td>1 기가바이트</td>
            <td>1 GB</td>
        </tr>
        <tr>
            <td>2<sup>40</sup></td>
            <td>1,000,000,000,000</td>
            <td>1 테라바이트</td>
            <td>1 TB</td>
        </tr>
        <tr>
            <td>2<sup>50</sup></td>
            <td>1,000,000,000,000,000</td>
            <td>1 페타바이트</td>
            <td>1 PB</td>
        </tr>
    </tbody>
</table>

## 응답지연 값
다음은 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값이다.
<table>
    <thead>
        <tr>
            <th>연산명</th>
            <th>시간</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>뮤텍스 락/언락</td>
            <td>100ns</td>
        </tr>
        <tr>
            <td>주 메모리 참조</td>
            <td>100ns</td>
        </tr>
        <tr>
            <td>Zippy로 1KB 압축</td>
            <td>10us</td>
        </tr>
        <tr>
            <td>1Gbps 네트워크로 2KB 전송</td>
            <td>20,000ns = 10us</td>
        </tr>
        <tr>
            <td>메모리에서 1MB 순차적으로 read</td>
            <td>500,000ns = 250us</td>
        </tr>
        <tr>
            <td>디스크 탐색</td>
            <td>10ms</td>
        </tr>
        <tr>
            <td>네트워크에서 1MB 순차적으로 read</td>
            <td>10ms</td>
        </tr>
        <tr>
            <td>디스크에서 1MB 순차적으로 read</td>
            <td>30ms</td>
        </tr>
        <tr>
            <td>한 패킷의 캘리포니아로부터 네델란드까지의 왕복 지연시간</td>
            <td>150ms</td>
        </tr>
    </tbody>
</table>

### 결론
- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색은 가능한 피하라.
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라(gzip).
- 데이터 센터는 보통 여러 지역에 분산되어 있고 센터들 간에 데이터를 주고받는데는 시간이 걸린다.

## 가용성에 관계된 수치들
- 고가용성은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 말한다
- 관습적으로 숫자 9를 사용
<table>
    <thead>
        <tr>
            <th>가용률 시간</th>
            <th>연간 장애시간</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>99%</td>
            <td>3.65일</td>
        </tr>
        <tr>
            <td>99.9%</td>
            <td>8.77시간</td>
        </tr>
        <tr>
            <td>99.99%</td>
            <td>52.60분</td>
        </tr>
        <tr>
            <td>99.999%</td>
            <td>5.26분</td>
        </tr>
    </tbody>
</table>

## 팁
- 개략적인 규모 추정과 관계된 면접에서 가장 중요한 것은 문제를 풀어 나가는 절차다.
- 근사치를 활용하자. 계산하는 시간이 아깝다.
- 나중에 살펴볼 수 있게 가정은 적어두자
- 단위를 붙이는 습관을 기르자
- 많이 출제되는 개략적 규모 추정(QPS, 최대 QPS, 저장소 요구랑, 캐시 요구량, 서버 수 등) 계산은 미리 연습하자
